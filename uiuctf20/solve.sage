p = 0xfffffffdffffffffffffffffffffffff
a = 284470887156368047300405921324061011681
b = 126188322377389722996253562430093625949
g = (0x7b6aa5d85e572983e6fb32a7cdebc140, 0x27b6916a894d3aee7106fe805fc34b44)
fault_flags = [(37905296586647428917036041789291900007, 57570868308920834002813463744376583324), (118063565223130511124183153444184395852, 30056660568356831983903200231637648354), (220030274252499074969703590188524033944, 196350983734050213623552092582350264773), (262066366795812165133085328481575559109, 99707255525776421784795558148413644377), (92052735325170063135575483760981971162, 333709969152027425891516562909703142331), (253205623726443215107579095704190743998, 99370092082471936831604591839856181026), (134765831453932938302988563802503019269, 188693754716683819848682988551041140911), (292380836990400396632721557930026602148, 280882399976491830758904889630543340979), (240111790417669895343204105477393779969, 12907437496566863450001331882405182135), (68127138503915727437910529294712785350, 173696570638991678999626592425455249538), (193999380388521757264604981795813570576, 163302134427549811226464277966564971696), (158441267970627584377754966072683802753, 245414294085051997911826688451858400258), (150243461160029297042831596808118886767, 80523504915677627308977336506555953843), (185411806517031146051255536811018049422, 261445765873823630087548622261969116856), (157900606257266510516364467364855799104, 277832921332286354381726502054181084980), (259341113102089396628879229000566144175, 196177338769625674225217544526232085292), (325850549496009461596455621301728776468, 81550112762470072862341337105789280102), (131113838844577013618591855614307578263, 290493260075514743125722948076961554845), (177206408089340207228126735361304685405, 306701830892234097179566337002243884296), (229363112814556527097221164849500563561, 280396900324676701246960765239805152706), (330793527410205073286923836277428598945, 192366871651235094482762376319880024816), (118303387420063503409061192514323936704, 222169277420137792449547190853483328943), (102263511027580450233442007314807596313, 219394069483907603145121991914783137215), (204174728108729982097843894020931739525, 171097937527286201620402880111897201908), (299922619555282496962330837512337309252, 42997399753388621411389255658932077615), (13540825344342137602796923054033895724, 174149689399080400976445712330904681751), (232668791788673916414565160813789282008, 2171531216743804062888780611454095787), (11185751561790550132907219727557651861, 243818632303318867399745185391161531491), (306600399084773560352363264688966460895, 108609025952237932430066089916492810502), (182750122751107661251515698087160683800, 142011386842643635741448847597613156943), (70240652569622621648628547203841681437, 211240047995142754152647915279505139237), (239653275554217206750079372380825370814, 129687761153094153449226303401501395680), (169794723975808212401109345684139888025, 299432550466064439200442845574096591854), (303416275123740385168759028713984313421, 295007878721924719196205171232838753933), (335756173018637822655493275196366835880, 185812255160301344669040709410301062765), (29367149243272662443677520700068626952, 271740915153937546229791671276282392066), (117661639081452502016509710785369326886, 167961003642772431154331701650601702805), (146324471273600770385021821879070518871, 2210768652124640224546234843998421256), (216552770853076889458242021337113046082, 77535968674586671066001707339871646985), (164068583402045585913527373959796575088, 227322665446053014780353479236598622555), (210159206090574238514998836219106239669, 21992966977157660820131661870115168148), (257032528608290018192150478185489582481, 168329166546833142848093547507478335292), (13757732212156210239548283512042657198, 266973555763666942434743641333909305456), (231758916834647452300344599255109821045, 187943654725162692868792112091254095961), (246003151257841035154464960557694819227, 100180635411761224454048949397911596909), (315821633605138672928542924900791334505, 169077867961817357927811715991682949758), (136346030898398983363664512570590188206, 325823311822735716337478201342134555689), (336888609485639908352511251480836615937, 99813037272992149294716080647935409369), (33775228733705741956780638143071313383, 251226984143208110963336046928432020766), (15353565280607850557890139673924705043, 184913814167668002382417524355369973078), (295628074399457212864858818055521585400, 2580845461585892195297456373053245378), (19192463490889801219452194456786160327, 312466955594644499793541903138453172679), (116623470852620653334391175660837159569, 301076892074136712793005663941974380383), (103937344532435395978551123293249372988, 163550454942031763904110967506622681218), (248481662450352379252211247809589238807, 136192776466137999180087614934387034700), (291691531048812831498708733190982854965, 92175477017014290639157788951998388050), (325425237480391940832328363315163151537, 131628511178510069854485003402850563514), (164701707361361524721963895330936169006, 120275209015923493086996054644002751792), (206739322828186546613673513825503695186, 102713504689453177534641818767347586045), (113520925191367756472620326747075685047, 217963981325834007503947983992418372721), (311182221115342586923754819300199151894, 16869065232910403275284828864688108008), (263921916466957545363437056708912217368, 199638026999405547513160953259804532834), (43819003784401717572711080964321275634, 237901798172050071389387482738530751236), (64556403430383856217435389335947435975, 311826563739378739717820442704116609166), (8243284686380317156575885508419840663, 176637478416071041686336932985153212597), (311397986718383700074500162822596232320, 167162197781375078946765707831595290681), (153325699324848436567644331944943402445, 266247466566314516986632757727005528548), (79696574155314271047599411865413534285, 48715968365218255192319800230577655771), (158438677842446669890843380723451024859, 85511392086066718856235911033142915991), (221248952052268988171077111036428419820, 339981568209649355857381260339602955546), (181072553088340059539844392629825067133, 64484104585808182989779254649321772507), (146453944343838343293537850581716751058, 11144706956415549616314232447376015719), (105801602081542617609358327758944649093, 232367582706799488697771724973960597357), (210357709450302891279896813437425631036, 252009477686334895495947765796525963092), (335221422462813065354648054925240561036, 165747811963410996275654686093880570201), (15460758667655252655598512610978561068, 3495556771740493073648210446466289541), (54803237636582455408955240899901448060, 75027806446944459545005959854041496322), (131038870062596661857630695328853144157, 88974834315513031029379536962830053584), (90557823756534905980879099810941306358, 121353790888769938278449686600782063913), (240578656832676436160288657431732888430, 184400907474295589310446339568861739543), (96683193832476379901753028437413618583, 230684644821473305758282249162814709593), (147350987823983165567441500677485950050, 145500148823526336878162473876755679880), (252695472346298566729229434083391530247, 145806907213872917273389451166254297911), (208181208773879760433094363024081697539, 339415341070017979504724730568197562179), (90202046663611888167653158541426304850, 318853631408271867226339998264287247552), (233767734958204411483218410771727280582, 83014154833495857970235988085495868690), (4655919715802227432245361605835962984, 73126092960052988917381354252404206969), (313382272618618956993404502190599824077, 315320102882399711866280450182666153593), (34962816482658736944798555391839175625, 241247606842278047084532218904268903856), (209914991161308277193671448088954828924, 142532333205472834017375615950620083154), (232835033308982756569830288586755422306, 74284295632032610185158660148906183106), (74287135360666255020772725374021242665, 271954679473890406401530472718390838691), (61460533175482040077595734115890435396, 336678648606954273840686841972568494905), (197699971187250795149850686110654354135, 322190585431834791090426727819831031009), (297352790286164030253918663109498669285, 229466166354483126619265319432947105713), (78413647648860013536713008011237692751, 188979398612447776257491687173649452548), (147286512358999582463699297064379292423, 129571059097394600089192438932560038425), (201371426819996946576236138283521435399, 206478878364465190173602428509530836045), (1567738737425316414599004540815074717, 260226429398687950688641261353573409693), (237202456905854544219228765543405288548, 303236152101754516393146793476413766119), (119694122330145619525010212484444047038, 278773775794410003961220361873086499905), (98557818695738928011391603083273165754, 168232450838244052513046858394234420252), (131964960738988063112865213370971663345, 121135605692907683720832520601672503801), (175353748065643400308938995486739240963, 104748451897576801959701547153703951653), (121140275756338809679039749702733124385, 108939791685923280905185375199507649418), (298424317240753899079087076557210045031, 142583972195486334168636875101482656983), (100748110736929154946871337027899785908, 257507757779245391296292204293659072205), (18749984291358928107683000287302071480, 253206870356451358627664333912681905161), (45160776998598574439904220647655976633, 56506281572940831338117865547019508917), (116438180638488131860055806007041011727, 330115699554150648452439910861409583376), (258364698519384849250681945396406771965, 146747365771168747950891756998121789137), (216255570565604313750062916350131952494, 294902240551608355510944851664135739655), (253374536621597583323283804080200763298, 161545412860910465573099492740312064264), (248088441543698707994142627806500778195, 264354933097630891353709217118342277919), (239006411114325540193208754422946133796, 118602659426140860367342160496789406006), (15128159120530039111862195893361388618, 205826845325794321220911300872168023259), (88978387888394962686069511304519540504, 129021751871210023664989517340207416284), (214861059757674544425356676875120670914, 134965417641466157539069593078611698360), (52467719970382648744543876134804965776, 135685487275040805283706475046345390179), (190062666478384441333067258261531784606, 217999295175481798304419796151393189649), (63728843727361243749728000963590107306, 212707672235377092556947841775933827089), (236406215266983703145755258719673931084, 87345895650954235262308929572862485418), (286853680756737172864575321733782386073, 171343890273917077186477387892706385316), (236569132729815279619865556739703995168, 176448725116778391597824908370134779082), (147432457116956996921795031204026469001, 235012707493911538030736314039292543092), (281190239112950688941122512826857264716, 313424950222969284725191876727567680257), (260839884893585795742557765393633123944, 19465797347233618307836673929767501879), (83568695582120697623693274431160992834, 282260793667505401786110894276893097334), (243094375228372409284901734008906688292, 126424923130951572257861883998167517228), (97547741675811342089818904828217856649, 182847216813152978747073842516313578511), (226593006826124425489849917061044614316, 316552477067019314822458856432813436968), (30923348442044578121153494664762132368, 245169818026376262460810638797001531197), (56590828006032006055597594332668493947, 194935554293457956595715239864768410344), (148341322747493217059322162948278501589, 269668294563704089759629778293558990661), (19699022679739858189366890759504831322, 248750858634726951516965899099031783867), (85050981801158625960196359926107407494, 108092648348955271408052539721797217718), (247715525189233335741973971198511213782, 34007751564951628826037432024862405958), (113999342209115133102047176029431676729, 30010943014230784347104468597037167452), (118076860129756803036693233483006651855, 428166874198138778865978773135810219), (146947237489632742626566349750813777112, 276628898795358868402427243982419269920), (196285274533736626058237546098958032261, 287132537160277155657680712052050582710), (302819477861706708049117043325363584724, 66459458498017546792137843506498650105), (194296040552754036505835569252591955056, 262276214246072688289366214106945611061), (207933116455936214128083752127193168165, 25685321991296234984128166222822976296), (130589729594858510704364966156869756878, 29661028425053675535581865710077880691), (5127904330026981794077624021137054011, 167251964989691744750507855574492879364), (19304093621331437819241733832046089127, 59164618612419766294695818486121799345), (323456820020481041705575310770892908917, 283008478314533248145338284670602628668), (200253300499600437123669714321419393323, 90610026723223630215449746854504181675), (28782637851737704325576261284788660267, 235678558639618738246026049711354206201), (78086893415820106244836262954986275571, 205254236586803528993436825117132294744), (132562233674077774091078960287131541764, 321941455772601951895451303718517834581), (204820694070899388029241181918486892162, 149225792488056014247097696231390441672), (229336492947739981723215191630236133746, 66128433395515012195740303756842347448), (280554300970163248330508242685566165395, 39023503584849458636383442377455037604), (54430233831057417324323387138433652220, 217676094132230197952958613198667371922), (63014364991801783522704146880153623018, 202797785168286667796108899395355876720), (329112588968013095190760051238568657102, 46230433560628864596445600267483880564), (227414607073835327198777128002162384321, 316981626245277924363042384914839005882), (222433233877084955052018217337523982277, 56854970607405330572920225497842148894), (314383255099736871949419871193286517026, 320621720870369858199292706861186468790), (60597448652474000497388643457151817842, 63062631080195185390715593599381714519), (19295266122535116042443029385511252205, 235840809285962563418608430643696756336), (237219112322206112248890191296683966793, 140958914632427142838105959437867223958), (306183395705138203946372786283879061610, 74249370584773121340682528728846851832), (132187689384669809111588029090524637469, 249888840285787966316602531092117816631), (299219105898149147738763635031024777593, 269171259638820364942817409414374558014), (31009624039975379950142715817484033734, 74623990939363846143177390833523597370), (53483906339391573908373013746694956956, 101345747256483002365282677972726894685), (8987729584435033384739902123881547909, 167432408963920000631663319472927762333), (97509155753616738121994260088352942011, 298010450330213058201606199870750705840), (167215064017206303270804003684757937354, 244295677368432092459467900939224800773), (74092853907367234215870385261971227191, 303106619986398986720295150694563459384), (126544217539675015183641634388611157069, 172591441978623721891113957767692366160), (166829432781633939568621146766401616128, 337430931132952052205779762754274012438), (6082397100634889205791708355665391215, 241389035789973869060783141955042301093), (4321721661282205570123294254329616497, 151834996838817248686162866867872908968), (317605859891160299192782284859644453147, 975012775042317446448303756683202397), (59022081021369407340319235707675264803, 32625328985107887402786088128817958034), (300432989658030355187954323871333821811, 69110611579435410275171910607552417622), (5999251841993189938595246056907823187, 322169618067722782736053208697789638433), (173447399615162561235432516188622144892, 333127197101179127319766570328786761232), (56185931430282834824102393913450750275, 288151483852249987067485055110343413064), (48460404068323621121207730568405873452, 272208725632087392689356578566588578474), (336733155924738920156865753591807799916, 298169887145566976638165077174340949605), (27883230391002206499193679423558001093, 140164935104579562630405089389239257419), (123833604402542955803582986682510255731, 171940484179969387689888197009137914733), (339345468090598768040455349904256835210, 2970897580084656617782421288912599395), (260929619706699669047898432624121351832, 331839563455987159030637879952981380947), (102974471723974878632941714365445584310, 144777440406434086192394753080355918219), (79564855631808653344535907344950244520, 156923959050347540721218638698374158793), (299928777341077429405688115976558821122, 54100468568627116145708188507996475616), (294359292049136550212643137204855477363, 190758318664039467504440491407046668325), (169270910126575904879926293606573879612, 281632950628812407174876314829039487412), (166162782216740192815826204130961126641, 202436184412741329732817052922253935665), (255166151046924514597945530961293897347, 140295370466882475857123589025920726193), (76717540259273075840400799178777253041, 99971862314600884944174132543475751418), (115860380108665200745726336648358312795, 312876525938466084622386072214520890735), (8029923694667905956817643215042786312, 138533045661171809831515176678257540954), (242343653689111945845742050692051958434, 73279638130073705681625729982881520427)]
fault_hellos = [(37367675909018932199781407434375225953, 301406416860163250785871678886489320283), (65762394008653765643959539155032542381, 152928153580766750092605807683440141905), (76307927034338152044566257100190179681, 58137295220679521502931065777439757069), (320065780830843099896908835742805183203, 276838913554802197529413883908595114123), (75779549998238238151357317573381195590, 321665220616979467817547286073492870099), (244744281736741486004585750902636036980, 307818175668061715009671032141500585267), (93154954019261364290955243548586977846, 337566563112996311558758034415001872317), (301725365463824019788556641470480623199, 172717920931357042551683650913849996821), (55483764577342780228462747428361419289, 280916475493981486278119733752469838058), (103483426253609907575227281383350887981, 270987214856913215450243564135558210644), (254356891271671542063079958749830580799, 190547107507677730694101722823432043875), (139511639017294259635055285999764949975, 297640559445900416147336075933375464203), (269504212868955225973112121514086109601, 301683497682305790331660286332191946332), (66090781011623957926972599437996080505, 307003141477265468774069209374842580763), (239386735774109578487738836048006242549, 64851477503188630085584491587289625847), (323981167804736196005365471826304579209, 38745971542422721631469340391907501559), (28351696733080727212062823330916005035, 262302903938175785317175167872844833302), (250972148760680312941453112853534380575, 333516641700476875211694889780997733417), (229404222762486366591880230343589858971, 219180444664020497010460552988744257152), (256720299032037495226940343308570980125, 17656662976570385538372366630629848134), (50563998125752513457774570553608636593, 62218642315456579924874525036230879424), (303777201425636547517135927018140442747, 27107564946701379914967768874786368048), (98678388609976230594129425726458491171, 254460431019452987205693333972640688550), (306884697480872358267093249153942459657, 165932217189279641735198140195838787985), (251650966018459387232675989144363861972, 210568750254452012960825345740868379732), (81968305263919812677688045744991057158, 249751428532290784053695953049092025897), (320984349749434189771299963492547243676, 335882015371446949184013640202095134965), (21457800455772554378661027564235513146, 228600853735411982896537112410096730005), (227429181723270375139862167926118253214, 117369282793980532625665555645157425190), (33567308176322172683117165241525352116, 58125205146687688141629759050496916581), (92036066045844216722530237996696248616, 224877682618898096526466038086353428457), (113030180402553957642541608777778640610, 256197507982408540354729199621872543053), (173776113034883067218469859284594345419, 329799731894482386325468435029233792844), (211969657301300320180271524696415234018, 51515994422674231139182503077654266675), (85281602687707327709473775525567843931, 196080503167738896676723451576665397568), (37249403344957493296424378839947607887, 316638263826981583862725364735519549233), (90808061928324792650126411590129114963, 84145312666977045189273504206043328660), (322902903771178837663130116155540547779, 227839426128405252691842460710200999497), (201940632452601940657283249383726381910, 89841000943944955832875032112193464765), (102534299961338356806817426302530862645, 230146549681617893752184768587340926898), (67598424893078268723698151767138361176, 169572872324168897430176466636072908243), (28380199328750332252070197901018338536, 254350991650503272473929418646136202581), (164580484975188626181385975376713010542, 315386809455674269680412280754294989464), (162400465895531417145649918138311794179, 217559576051163463576945215656187550590), (238769498821569901650482668753917872483, 271558346349807677172093400078020732707), (220623334280517637803605480769899183600, 221723602003942829470831083857132202213), (160497598945089020656904628069871354848, 163919796186723823227700437477134461281), (302132614919050549645461905264523058578, 169224995078658815290585167385863340820), (279530747024369219568951658056315093071, 72161252473656813810687095249712243822), (65912691758019384217985837073799820058, 124284562995774002946909300508116268374), (316225433410876197123339004071581741747, 212971548038225383306507930790657956596), (248658221058518226357678298602095672858, 305405584370115170017641021444812316103), (264798144470624430199646297097366734614, 235676246770913476395023056630598804041), (156653467413722904912643819549919680287, 161292438500862355025542593846269977886), (246060970238615782220170323090180964796, 49108108519828915187001176000794669789), (94217063507010699516748460863496878045, 186113081730896771845638576796214217192), (222027293932310544394153052728982457443, 188091162262478035142780977618323459504), (65254251040196114824260334309526741375, 109372391633754612690500699111843310092), (330273892099783214442618513317217973883, 199899573812834635439783632935220941569), (224404563383054545188733512509394124560, 189864179513204854209279851739574600848), (121880577665113569672519117706253811762, 160165221788986297543593478912542982615), (97652376970891296457719659673131039307, 311968758305360179816492317994880227735), (332842726760250029433500879633103289920, 5803757775015471407712742692891916333), (140395216036915664360514851016139878337, 79856957650891418934658021281905458645), (131008130808922202638903127171501935667, 312878455227136615623799556223303828933), (139131980420768366608189948599056449481, 283256602448360366661862337634882094068), (13665534758587016285796258034406832880, 302221869997890024976720236260190353685), (237600250792973800432047005731271480770, 176119636832216859832593218220559054028), (190760499653969456862074417938062964839, 275165322784339618535107580062223314718), (332784723849320472003806555225108554937, 221715501122462334302400935216910637702), (153454950599432512087027626481890587282, 105358512301368737586595291041100825430), (321697983063717647687268933754427972113, 143305485084371157943224746919934598691), (213123920096712467705084787555422895938, 307616389731985949523119952958139632057), (309935066813312476543813432176548196141, 331182530269234150398727003059317143397), (212646748376232293246585220204211632472, 184854909570816216799173428419302877502), (60767084119990655076865560354023901951, 153060205049377142909410055258848428494), (234943628680232749606863994573949679040, 254685407950034262140349297551392722538), (20629789958908887909308752592805368249, 212480627205253608603695397314227232826), (144920986922684654780438640992762348309, 41733121065793567283906591959392422387), (84598212728190565795378676770822617851, 41797711985718674321380554648064658355), (166427546823437625105385625424262267981, 145148900343518256751182188192080644224), (305155194063456882392627168957611250662, 31102471072128714532499868392320841328), (107698037078411974950015480200526903271, 285013611607513976528675230055110660259), (241616597241430089378301104624025059231, 323594028270598035814950555061862552224), (144981592254510334334632550107623608960, 258183474914324119221763807756553684163), (269165992056414073897660872953948994987, 151191095619208973104142784708506364600), (270686785257052915638934320288188736325, 53092396933376228248234417122543072524), (223792524837720007927226360574593968026, 114017727683196074622357420714919873739), (81164547649252761472331855304193964948, 203572763495481145650126290187000721704), (313526584625953633169176469368458120160, 46151559318591974756874310769965493493), (200392817579847336733345223925370367835, 70221756289903704258445344406865992987), (234124404831343375420667527911498286105, 303997818534741531516348508496552251811), (72043704236834014841127432836068136346, 15491280105966479508854321689109571734), (25499888663967335337662104580150737116, 308585391979986229078758720875816540411), (311157242315694752931161176282422862246, 192630861893365767102018660892272837206), (302996525784563600574523953045078318648, 83206333023618618652340894926979558594), (104729093741504997865569735189001765820, 195434548795604164451296580957086948142), (51725653794889929589164094381790675363, 54532005615664670012627858197521444555), (278148646136113742387909264989557031153, 232754258983991161824776974703397628531), (42932459772966925367598497712233011312, 30579024009138536336501413028456824422), (19596703642987025268479916121048689157, 270692389318460489859420988976945365790), (50526785760231813568308800338645919021, 310646170721017063259403519715222390311), (31618159434081486666090843792730690054, 7620021597793274914084088377401039626), (321870602236581590631328805130592425994, 41109877526427686182218990650800472458), (230732677444769393379063729653254264697, 62767416578863057549644499704235702497), (138617847220426124088537375765881586127, 198783420408164253140820191166837278871), (150824505113491580550962298125887159692, 273569384101966271712818808937442264629), (233593735362894470233803042353401812757, 74376926642789492806010317595419517129), (118627449749005923052679115921863709296, 11043512057643646231386009274200380622), (61677670326104095943242635962369111772, 159063453415717596307913366800008326202), (168147053259551401759122092524417989894, 10974601751579907280138489301581877936), (139233623284525098744676124074334612898, 189903159952989808882690871178976275883), (151404585361562360076597530256560305276, 106922436588029703216277304264743166054), (218319611510746543117087952019039173868, 154129900692643201246335462946508243982), (162880819825448299592286387763023049490, 61392546667551512818523251416321768016), (116469532075066212437512393429318320159, 276509708902385506479558416698591225643), (309487920956807359487417264941859872907, 98936112487399885583644923233398747818), (272728034731751063473935152154918523544, 25390679492566980430918567582552835638), (79210946496319672189698745054080102251, 18734259507240711517068977243543347056), (26461965573550956732320062809537558022, 240461216956575262761807315621535735085), (307412429894252555519856744841746177815, 78946767838126391653556533098739798350), (314892233422407726247608613531949236994, 222638758694185145783582887235919632361), (253986814818493399553226394045279649935, 61266237966241875759169557629838866269), (31773139541855857259090293187698479160, 316102492529152545659591601558312987533), (275613030097601504715417840355256726336, 3713996040746375612621245661322817683), (5172771021469781391471186128549671763, 26445100898534251514760858445198072232), (320916386031513432196743937568178737194, 4639846349357839863184107077774150767), (101898976783871362956942970612373675713, 285383877752934198262838221660628448969), (76802290453323494289246384002033378679, 113805541779762739130939414913379442334), (95186537106596011747217952282382965942, 208001670958518604319292389114102035647), (105390631523979949686160040634683010552, 62977403644345154126252413552500673654), (225510566636194832094682026452117560760, 42693379630732314224095196787330770836), (50474765427797927424293821327590201350, 192383924286898459275303638151401023232), (200661894687175311172619237640996892854, 278117432405825815749716754922795284254), (278891320296749033803080888045260637751, 144153555403522445252876201365014106713), (261198931283341715629294519122145329311, 99464837012026527215720358428516890469), (212750125288753936397237341681638336121, 146167770364325207416404721227716221912), (62553187173898875833252333061936247219, 125156780707525170938883073025000168751), (287867952793716822496874338816170420189, 235980556925021384427141470967567354059), (280648259474286972780647334659087775141, 31909453504673401171027525171060323878), (90838354195121087769627767388045573090, 294699689287276999304394533533085420851), (192930197111032470846166957338673131399, 261483234491083596991442825044066465199), (13563923528710657005185455435873886754, 47551972122263589050142678818579205555), (15116906065216264508842016521136307426, 306628333904970326699278762448770471770), (5165797057029199663997389396197609104, 334862863206156929828951235237236802566), (236394997612059633642203906859619566988, 116145389897312564431433614440045965109), (79762938456512892014257645885823480554, 47005569871469712762343878596723263960), (159780599862137788285815326869282498255, 41301124810092240978654922762428996980), (84258555150669913730493990698755412210, 105330834096728790231649550520605080926), (275763720005333586656838303894328221041, 336299452035539338803960274208121860130), (38849059904307857277625709716327205, 226878819901010848743785312227925387467), (298185549622531518717083138300703072553, 130474658821947364809096095715696503811), (281340080901760829873727525860898649895, 115551017874553747930977524577721522787), (272327799263378514775181786895226586123, 7786545641441988245474256341332825169), (89594641457837293043098078829995174703, 215641778368407060303216181827013329546), (238235004207167524253184659801829913244, 36190476755046103670630249952057591551), (317002471478176119765089222124547439434, 261315305829671055212950750708740637962), (31164257948273554343286759746919237390, 246461173099406072630926727748677878631), (60268940000580034602786640022085834830, 235466740105504090807055027172674080896), (111378976106791477521309503278445191415, 17501265008943198340779666526545419021), (109067969258914660346714859958420268177, 212724585645628568865831135177455177497), (101357850220342550342780620635352645338, 187407967801354421673196867537192729711), (84263870066545151426307821840405082773, 6381686633702004948108424226139339265), (731523902456446272132396205613364543, 101260602303599651843226606240849836067), (155585142352617795277062133983148407822, 237862141658154431744929252810388261254), (294232944317409582712627723561300690430, 56686995725105200668702140066241523913), (94033505189340029660556156262984051125, 307815758368341500563471725873485304532), (259298991193312206055564904861173366318, 312728055081534408842230507917301027715), (170443750871040647393231845764440994207, 99656109659673209878242108723476518108), (17696862079513189913572487423804307763, 200223282397681150672243711304118399513), (55420887150807335865541730398050199726, 10136153434222909775586146891598249417), (81267048940639076682590555467961779684, 148947676972891999750230075499500294734), (209443791732964636743682500746456238477, 299888533167125311971563431868080271638), (198259060470976696914873192568291422489, 101145319363281336310451117288487196172), (3349096264212041022453413843811879174, 93636147959203113797888288073783219158), (273992819317927402280174391738407680718, 286565074090037137189950961486475579538), (145733560742747943894411048672042209016, 271659429037354166098969045389750760506), (18592688261094851854437729199393426488, 47196526065805259315370440703134949166), (335163573363622276774467064993333486461, 249918801022309427263394588410709381154), (164852919558519700228318880185188202894, 190094559129522717437894586656373075808), (20046138762625520894442260022375136000, 51471336979081820347810781553362419145), (241758463823357337451597200753611073140, 290131540468573520140150009861711161166), (254708892651435507026809622137691696689, 174998139723863858689069608330927850759), (161029300419665507463414381549652110386, 308719220684098877219544224854278644886), (272592842132231302210633104772191016624, 231340294431165403234139295595433388333), (282263417527238764831260622973432526870, 230940920198603872459230712727019816407), (165281973660396644861617680624564105984, 120513564825062327080092604587575125698), (268632207558445750632531434183263460452, 270886580388966202579892708182835286496), (244156263235551043839967333478742725007, 89038750074186436383876381448151180092), (262807283642009225557427576301096548770, 249484300691976374680016822585084457564), (94541950273723568063908570103811423763, 112805233435439753009245363764126596074), (23038335121816297772239381713244967136, 121385296682913889453558819721426138327), (80361972310965924421860459368150986053, 190921356859996007843141961221304482186), (272223065769009628832907480117671926021, 9342666549127509276493064478286436091), (118908262203821948868369517054328788271, 158683512683313596785926771022228588586), (77603076499836236623944198072911335414, 104413371712460102072920196984998936370), (13882644042427249128110739555733829022, 309165271650937283299344301372696376738), (121462683818198442663212210960608463816, 287945533522134902229019729873339693270), (237807714918169547205810879911334038312, 322488304167825530681674353719406214429), (156760458813891790238361099352183555986, 321318931582257984749956902346776135484)]
int_hello = 0x68656c6c6f20776f726c64
assert(len(fault_flags) == 200 and len(fault_hellos) == 200)

def solve_b(prime, pt):
    return (pt[1]^2 - pt[0]^3 - a * pt[0]) % prime

def derive_modulus(fault_flag, fault_hello):
    c1 = g[1]^2 - g[0]^3 - a * g[0]
    c2 = fault_flag[1]^2 - fault_flag[0]^3 - a * fault_flag[0]
    c3 = fault_hello[1]^2 - fault_hello[0]^3 - a * fault_hello[0]
    modulus = gcd(c1-c2, c2-c3)
    if abs(modulus - p) >= 0xffffffff:
        return None
    return modulus

def derive_om(modulus, fault_flag, fault_hello):
    bf = (fault_flag[1]^2 - fault_flag[0]^3 - a * fault_flag[0]) % modulus
    assert(bf == (g[1]^2 - g[0]^3 - a * g[0]) % modulus)
    assert(bf == (fault_hello[1]^2 - fault_hello[0]^3 - a * fault_hello[0]) % modulus)
    Ef = EllipticCurve(Zmod(modulus), [a, bf])
    try:
        pt = int_hello * Ef(g)
        assert(pt == Ef(fault_hello))
    except:
        return None
    
    factors = list(map(lambda x: x[0], list(factor(modulus))))
    factors = list(filter(lambda x: x <= 0xffffffffff, factors))
    bs = [solve_b(factor, g) for factor in factors]
    Es = [EllipticCurve(GF(factors[i]), [a, bs[i]]) for i in range(len(bs))]
    orders = [Es[i](g).order() for i in range(len(bs))]
    mods = [discrete_log(Es[i](fault_flag), Es[i](g), orders[i], operation='+') for i in range(len(bs))]
    return orders, mods

def make_prime(orders, mods):
    assert(len(orders) == len(mods))
    res_o = []
    res_m = []
    for i in range(len(orders)):
        o = orders[i]
        m = mods[i]
        prime = list(factor(o))[-1][0]
        res_o.append(prime)
        res_m.append(m % prime)
    return res_o, res_m


def dedup(orders, mods):
    res_o = []
    res_m = []
    for i in range(len(orders)):
        o = orders[i]
        m = mods[i]
        if o not in res_o:
            res_o.append(o)
            res_m.append(m)
    return res_o, res_m

def crt(orders, mods):
    assert(len(orders) == len(mods))
    M = prod(orders)
    Ms = [M // orders[i] for i in range(len(orders))]
    parts = [Ms[i] * int(pow(Ms[i], -1, orders[i])) * mods[i] for i in range(len(orders))]
    return sum(parts) % M

orders = []
mods = []

for i in range(50):
    fault_flag = fault_flags[i]
    fault_hello = fault_hellos[i]
    modulus = derive_modulus(fault_flag, fault_hello)
    if modulus is None:
        continue
    om_res = derive_om(modulus, fault_flag, fault_hello)
    if om_res is None:
        continue
    o,m = om_res
    assert(len(o) == len(m))
    orders += o
    mods += m

o,m = make_prime(orders, mods)
o,m = dedup(o,m)
res = crt(o,m)
print(int(res).to_bytes(33, 'big'))
